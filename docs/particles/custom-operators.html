<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.7">
<title data-react-helmet="true">Custom Operators | Jacy</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://jacylang.github.io/dev-book/docs/particles/custom-operators"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Custom Operators | Jacy"><meta data-react-helmet="true" name="description" content="There are three ways I see:"><meta data-react-helmet="true" property="og:description" content="There are three ways I see:"><link data-react-helmet="true" rel="shortcut icon" href="/dev-book/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://jacylang.github.io/dev-book/docs/particles/custom-operators"><link data-react-helmet="true" rel="alternate" href="https://jacylang.github.io/dev-book/docs/particles/custom-operators" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://jacylang.github.io/dev-book/docs/particles/custom-operators" hreflang="x-default"><link rel="stylesheet" href="/dev-book/assets/css/styles.a61cb2a9.css">
<link rel="preload" href="/dev-book/assets/js/runtime~main.5325abd4.js" as="script">
<link rel="preload" href="/dev-book/assets/js/main.cfbc0c05.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dev-book/"><div class="navbar__logo"><img src="/dev-book/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/dev-book/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">Jacy DevBook</b></a><a class="navbar__item navbar__link navbar__link--active" href="/dev-book/docs/index">Docs</a><a class="navbar__item navbar__link" href="/dev-book/user-guide">User Guide</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jacylang/jacy" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Jacy on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/jacylang/dev-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>DevBook GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">üåô</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">‚òÄÔ∏è</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/dev-book/"><img src="/dev-book/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/dev-book/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m"><b>Jacy DevBook</b></a><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dev-book/docs/index">Jacy DevBook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dev-book/docs/how-to-run">How To Run</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">The Concept</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CLI</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Compiler Workflow</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Code Docs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Particles</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Lincy</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Compile Time Evaluation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/assignment">Assignment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/computed-properties">computed-properties</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/custom-allocators">Custom Allocators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dev-book/docs/particles/custom-operators">Custom Operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/function-type-&amp;-names">Function types &amp; names</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/index">Particles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/memory-leaks">Memory leaks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/not-prepedent-op">`not` prependent operator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/null-coalesce">Null coalesce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/operator-constructors">Operator-Constructors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/optional-chaining-&amp;-try">Optional Chaining and the Try operator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/organic-jacy">Organic _Jacy_</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/refs-&amp;-moves">References and move semantics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/soft-keywords">Soft keywords</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/std-annotations">`std` annotations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/strings">Strings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/type-ascriptions">Type Ascriptions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">syntax-decisions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Ideas</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Appendices</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">JON (Jacy Object Notation)</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Custom Operators</h1></header><p>There are three ways I see:</p><ol><li>Do nothing üòê</li><li>Fully customizable operators such as what Swift does</li><li>Operator sets</li></ol><p>Skipping the first option let&#x27;s talk about 1. and 2.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="full-customization">Full customization<a aria-hidden="true" class="hash-link" href="#full-customization" title="Direct link to heading">‚Äã</a></h2><p>Pros:</p><ul><li>User can define any operator (s)he wants (nice for math)</li></ul><p>Cons:</p><ul><li>Highly increases lexing and parsing</li><li>Possibly makes parsing context-dependent (I don&#x27;t respect it)</li><li>Or, instead of context-dependent parsing we need AST transformations</li><li>Requires special</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="operators-sets">Operators sets<a aria-hidden="true" class="hash-link" href="#operators-sets" title="Direct link to heading">‚Äã</a></h2><p>This conception might be not popular, as I&#x27;ve never seen an idea like that. Anyway, for me, it sounds not really weird.</p><p>The idea is not to allow creating custom operators, but instead allow to use one of predefined. This, predefined operators are not common and should not be used in std, instead, the user is free to use them in a library.</p><p>Pros:</p><ul><li>No additional complexity in parsing</li><li>More specific practices of usage</li><li>Don&#x27;t need DSL</li></ul><p>Cons:</p><ul><li>Static precedence (predefined operators cannot change precedence)</li><li>Worse for &quot;primary&quot; <em>Jacy</em></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="specs">Specs<a aria-hidden="true" class="hash-link" href="#specs" title="Direct link to heading">‚Äã</a></h2><p>This is the specification proposed for the second way -- fully customizable operators. Operator sets do not need any specification as they just use the common way with traits and implementations.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="what-do-we-need">What do we need?<a aria-hidden="true" class="hash-link" href="#what-do-we-need" title="Direct link to heading">‚Äã</a></h3><p>To prepare the compiler for custom operators we need to establish some things required for it.</p><p>From the view of syntax we need:</p><ul><li>Literal tokens or a solution to tokenize operators</li><li>Syntax for operator information description</li></ul><p>From the view of working with AST:</p><ul><li>AST transformations to unflatten operators</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="ast-transformations">AST transformations<a aria-hidden="true" class="hash-link" href="#ast-transformations" title="Direct link to heading">‚Äã</a></h4><p>I see two ways to solve the problem of lack of information about operators at the parsing stage:</p><ol><li>Require user to write operator declarations before usage and make parsing context-dependent</li><li>Make operator declarations items and transform AST right after parsing</li></ol><p>Why not 1. way? - I don&#x27;t want to make new C or C++, requiring the user to declare everything before use to disambiguate parsing, etc.
Operator declarations must be the same as function, struct, ... declarations -- in <em>Jacy</em> they called &quot;items&quot;.
Before name resolution, all items are declared, it allows the compiler to resolve items that haven&#x27;t appear in code so far.
I consider making operator declarations items as a good solution.</p><h4 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="syntax">Syntax<a aria-hidden="true" class="hash-link" href="#syntax" title="Direct link to heading">‚Äã</a></h4><p>For now, I propose this syntax:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jc"><pre tabindex="0" class="prism-code language-jc codeBlock_23N8 thin-scrollbar" style="color:#5C6166;background-color:#FCFCFC"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#5C6166"><span class="token plain">// Operator type declaration</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">operator type Assignment {</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">    higherThan: Pipe</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">    lowerThan: Additive</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">    associativity: left</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">}</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">// Operator declaration</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">infix operator `√ó=`: Assignment;</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">struct S {</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">    field: int</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">    mut func `√ó=`(rhs: &amp;Self): &amp;mut self {</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">        self.field *= rhs.field</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">        return self</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>operator type</code> pair is used to reduce the count of keywords against Swift solution with <code>precedencegroup</code>.
<code>operator</code> might be a soft keyword in the future, anyway as all of the keywords, for now, it gonna be a hard keyword.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="reserved-operators-non-overloadable">Reserved operators (non-overloadable)<a aria-hidden="true" class="hash-link" href="#reserved-operators-non-overloadable" title="Direct link to heading">‚Äã</a></h3><p>Some operators are inexpressible with code as they require more complex internal transformations.
E.g. <code>|&gt;</code> operator passes lhs to rhs (function) -- we can someway implement this behavior but it won&#x27;t be extensible as if we would like to add placeholders like <code>a |&gt; b(_, 123)</code> where <code>a</code> is passed instead of <code>_</code>.</p><blockquote><p><strong>Reserved operators cannot be overloaded or used as function name</strong></p></blockquote><p>Reserved operators:</p><ul><li><code>=</code> - Raw assignment is always per-byte copy operation</li><li><code>|&gt;</code> - Transforms AST, that is it is a syntax sugar</li><li><code>or</code>/<code>and</code> - These logic operators are short circuit, thus cannot be overloaded without lazy evaluation (no lazy in <em>Jacy</em> so far)</li><li><code>...</code> - Spread operator is not a real operator (maybe it will be changed in the future), it is mostly a punctuation sign with different behavior depending on context.</li></ul><p>Reserved operators also include special cases described in <!-- -->[Lexing]<!-- --> part below, these are:</p><ul><li><code>&lt;</code> (as prefix)</li><li><code>&gt;</code> (as postfix)</li><li><code>&amp;</code> and <code>*</code> (as prefix)</li><li><code>?</code> (as prefix, infix and postfix)</li><li>and punctuations <code>//</code>, <code>/*</code>/<code>*/</code> for comments, etc.</li></ul><blockquote><p>Punctuations are recognized on lexing level, thus a user won&#x27;t get an operator at all.
For example, if code is such as <code>func /**/()</code> the error would be like <code>Expected function name</code>
rather than <code>Cannot use /**/ as custom operator</code> as comments are processed before and ignored.</p></blockquote><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="trait-operators">Trait-operators<a aria-hidden="true" class="hash-link" href="#trait-operators" title="Direct link to heading">‚Äã</a></h3><p>Trait operators are overloadable operators with syntax inexpressible as prefix, infix or postfix operators, e.g. <code>()</code> for invocations. Of course, we would allow writing something like <code>func ()() {}</code>, but we&#x27;ve got a rule: &quot;All operators that are written as identifiers (such as in <code>func +</code> where <code>+</code> is an ident-like) -- are customized if not reserved&quot;, thus there&#x27;re no special case: you can overload <code>func ()()</code> but cannot define <code>postfix operator ()</code>.</p><p>Trait operators are pretty the same as those defined in Rust in <code>std::ops</code> module, but some Rust standard operators became custom operators.</p><p>Available Trait operators:</p><ul><li><code>Deref</code> and <code>DerefMut</code> for <code>*a</code> prefix operator.</li><li><code>Drop</code> - not a real operator, anyway it is included in <code>std::ops</code> module.</li><li><code>Fn</code>-like traits (not sure if there would be many like <code>Fn</code>, <code>FnMut</code> and <code>FnOnce</code> as in Rust) for <code>a(...)</code> invocation operations.</li><li><code>Index</code> and <code>IndexMut</code> stand for <code>a[...]</code> and <code>a[...] = ...</code> operations.</li><li><code>Unwrap</code> stands for <code>a!</code> operation, it is a trait operator as it would likely have complex code transformations which are inexpressible in code.</li><li><code>Try</code> stands for <code>a?</code> operation and the reason being a trait operator is the same as for <code>a!</code></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="nullable-operators">Nullable-operators<a aria-hidden="true" class="hash-link" href="#nullable-operators" title="Direct link to heading">‚Äã</a></h4><blockquote><p>Disclaimer: <em>Jacy</em> does not have <code>null</code> and by it, I mean <code>Option</code> type constructor.</p></blockquote><p>This dilemma I came up with is about functionality that Rust has /vs/ functionality of more common nullable-operators.
In Swift, <code>a?.b</code> means <code>if a is not null then get property b of a, otherwise end up with nil</code>.
On the other side, in Rust, operation <code>a?.b</code> means <code>if a is not Option::None/Result::Error then get property b of unwrapped value a, otherwise RETURN None/Err</code>.</p><p>I don&#x27;t want to discuss the generality of the Rust <code>?</code> operator, instead I want to bring up the subject of having both functionalities.</p><p>Questions I have:</p><ol><li>Do we need the Rust-like error-propagation operator? - Answer is yes, otherwise there wouldn&#x27;t be any questions.</li><li>What is better for <code>?</code> operator - error-propagation or optional-chaining?</li><li>What operator to use for error-propagation or optional-chaining if some of them would use <code>?</code> operator?</li></ol><p><strong>Question 2.</strong></p><p>Operator <code>?</code> is pretty common in many languages (JavaScript with its <code>?.</code>, Swift with <code>?</code>, etc.), and the behavior with returning an error on fail is pretty uncommon and specific to Rust.
Keeping this in mind I would say that <code>?</code> should mean optional chaining.</p><blockquote><p>SOLUTION: <code>?</code> stands for &quot;optional-chaining&quot;</p></blockquote><p><strong>Question 3.</strong></p><p>In question 2. I said that would like to see <code>?</code> as an optional chaining operator, so now I need to choose an operator for the error propagation. It must be a non-conflicting postfix operator with obvious meaning.</p><p><code>??</code>, <code>!!</code> or <code>?!</code>, and other combinations of <code>?</code> and <code>!</code> are conflicting as meaning is hard to comprehend if we unwrap</p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="lexing">Lexing<a aria-hidden="true" class="hash-link" href="#lexing" title="Direct link to heading">‚Äã</a></h3><p>Lexing can be hard with custom operators.
Let&#x27;s at first describe what symbols can operators contain, start/end with, as these rules are required to avoid breaking the entire language syntax.</p><p>These symbols are considered white-spaces (in sense of operator lexing):</p><ul><li><code>(</code>/<code>)</code>, <code>[</code>/<code>]</code>, <code>{</code>/<code>}</code>, <code>,</code>, <code>:</code>, <code>;</code></li></ul><p>I would start with punctuation symbols/sequences which are disallowed in operators at all:</p><ul><li>Reserved sequences: <code>//</code>, <code>/*</code>/<code>*/</code>, <code>=</code></li><li>Prefix operators: <code>&lt;</code> (used for generics), <code>&amp;</code> (used for borrowing), <code>*</code> (used for dereferencing), <code>?</code> (reserved for some use)</li><li>Postfix operators: <code>&gt;</code> (used for generics), <code>?</code> (for short-circuit optional chaining)</li><li>Infix operators: <code>?</code> (reserved for some use)</li></ul><blockquote><p>Operator <code>*</code> is reserved for dereferencing use as it is context-dependent.
Depending on context mutability where <code>*</code> appears - different trait method called (<code>Deref</code> for immutable dereferencing like <code>*a</code> or <code>DerefMut</code> for mutable dereferencing like <code>*a = ...</code>)</p></blockquote><p>Operators can begin with: <code>=</code>, <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&amp;</code>, <code>|</code>, <code>^</code>, <code>?</code>, <code>~</code>.</p><p>Even though operators cannot contain <code>:</code>, there&#x27;s one special case -- <code>:=</code> operator which is overloadable.</p><p>Custom operators containing dot must begin with a dot to be full operator, so if an operator begins with <code>.</code> then it can contain more dots after, if not then it is split into two/more operators:</p><ul><li><code>%.%</code> is a <code>%</code> followed by <code>.%</code> operator</li><li><code>.%.</code> is a full operator <code>.%.</code></li><li><code>..</code> and <code>..=</code> (natively &quot;range operators&quot;) are full operators too</li></ul><p>Symbols that might be used as part of custom operators (maybe only in the middle or beginning/end):</p><ul><li><code>$</code> (often used in functional languages but in <em>Jacy</em> proposed for macros and maybe lambdas)</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="problems-to-solve">Problems to solve<a aria-hidden="true" class="hash-link" href="#problems-to-solve" title="Direct link to heading">‚Äã</a></h4><h5 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="generic-params-problem">Generic params problem<a aria-hidden="true" class="hash-link" href="#generic-params-problem" title="Direct link to heading">‚Äã</a></h5><p>When an operator ends with <code>&lt;</code> here comes a problem:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jc"><pre tabindex="0" class="prism-code language-jc codeBlock_23N8 thin-scrollbar" style="color:#5C6166;background-color:#FCFCFC"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#5C6166"><span class="token plain">func &lt;&lt;&lt;T&gt;(other: T) {</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#5C6166"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Anyway, I already proposed a syntax where function generics are written after <code>func</code> keyword (like in Kotlin) instead of after identifier.
So, this would be parsed successfully:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jc"><pre tabindex="0" class="prism-code language-jc codeBlock_23N8 thin-scrollbar" style="color:#5C6166;background-color:#FCFCFC"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#5C6166"><span class="token plain">func&lt;T&gt; &lt;&lt;(other: T) {}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h5 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="function-overloading">Function overloading<a aria-hidden="true" class="hash-link" href="#function-overloading" title="Direct link to heading">‚Äã</a></h5><p>One more problem I found is that some desired functionality requires function overloading.
For example, in <em>Jacy</em> as in Rust I would like to be able to use <code>..</code> and <code>..=</code> range operators not only as infix operators but also as prefix and postfix like <code>a..</code>, <code>..b</code> and <code>..=b</code> (<code>a..=</code> does not exists, as obviously <code>Infinity + 1</code> is <code>Infinity</code>).</p><p>There&#x27;re three solutions I see:</p><ol><li>Disallow one-sided range operators until operator overloading will be implemented.</li><li>Make range operators trait-operators only, thus disallow to customize them.</li></ol><p>The 1. solution sounds better for me as I assumed to implement function overloading in the future.
If one day I&#x27;ll 100% establish that <em>Jacy</em> would never have function overloading -- 2. variant will be used.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/jacylang/dev-book/edit/master/docs/particles/custom-operators.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/dev-book/docs/particles/custom-allocators"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ <!-- -->Custom Allocators</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/dev-book/docs/particles/function-type-&amp;-names"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Function types &amp; names<!-- --> ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#full-customization" class="table-of-contents__link toc-highlight">Full customization</a></li><li><a href="#operators-sets" class="table-of-contents__link toc-highlight">Operators sets</a></li><li><a href="#specs" class="table-of-contents__link toc-highlight">Specs</a><ul><li><a href="#what-do-we-need" class="table-of-contents__link toc-highlight">What do we need?</a></li><li><a href="#reserved-operators-non-overloadable" class="table-of-contents__link toc-highlight">Reserved operators (non-overloadable)</a></li><li><a href="#trait-operators" class="table-of-contents__link toc-highlight">Trait-operators</a></li><li><a href="#lexing" class="table-of-contents__link toc-highlight">Lexing</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/dev-book/docs/index">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/jacy" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2021 Jacy DevBook, JacyLang team.</div></div></div></footer></div>
<script src="/dev-book/assets/js/runtime~main.5325abd4.js"></script>
<script src="/dev-book/assets/js/main.cfbc0c05.js"></script>
</body>
</html>