<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.7">
<link rel="alternate" type="application/rss+xml" href="/dev-book/blog/rss.xml" title="Jacy DevBook RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/dev-book/blog/atom.xml" title="Jacy DevBook Atom Feed"><title data-react-helmet="true">References and move semantics | Jacy DevBook</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://jacylang.github.io/dev-book/dev-book/docs/particles/refs-&amp;-moves"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="References and move semantics | Jacy DevBook"><meta data-react-helmet="true" name="description" content="This particle among the magnitude of others is about memory management in Jacy."><meta data-react-helmet="true" property="og:description" content="This particle among the magnitude of others is about memory management in Jacy."><link data-react-helmet="true" rel="shortcut icon" href="/dev-book/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://jacylang.github.io/dev-book/dev-book/docs/particles/refs-&amp;-moves"><link data-react-helmet="true" rel="alternate" href="https://jacylang.github.io/dev-book/dev-book/docs/particles/refs-&amp;-moves" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://jacylang.github.io/dev-book/dev-book/docs/particles/refs-&amp;-moves" hreflang="x-default"><link rel="stylesheet" href="/dev-book/assets/css/styles.45508a18.css">
<link rel="preload" href="/dev-book/assets/js/runtime~main.58d12d78.js" as="script">
<link rel="preload" href="/dev-book/assets/js/main.c2ebe015.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dev-book/"><div class="navbar__logo"><img src="/dev-book/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/dev-book/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">My Site</b></a><a class="navbar__item navbar__link navbar__link--active" href="/dev-book/docs/index">Tutorial</a><a class="navbar__item navbar__link" href="/dev-book/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jacylang/jacy" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Jacy on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/jacylang/dev-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>DevBook GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ðŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ðŸŒž</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dev-book/docs/index">Jacy DevBook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dev-book/docs/how-to-run">How to run</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Lincy</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">appendices</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">cli</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">code-docs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">compile-time-evaluation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">compiler-workflow</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">concept</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ideas</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">particles</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/assignment">Assignment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/computed-properties">computed-properties</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/custom-allocators">Custom Allocators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/custom-operators">Custom Operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/function-type-&amp;-names">Function types &amp; names</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/index">Particles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/memory-leaks">Memory leaks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/not-prepedent-op">`not` prependent operator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/null-coalesce">Null coalesce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/organic-jacy">Organic _Jacy_</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dev-book/docs/particles/refs-&amp;-moves">References and move semantics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/soft-keywords">Soft keywords</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/std-annotations">`std` annotations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-book/docs/particles/strings">Strings</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">syntax-decisions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">roadmaps</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">suggestions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">user-guide</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>References and move semantics</h1></header><p>This particle among the magnitude of others is about memory management in <em>Jacy</em>.
Here I want to discuss one of the hardest questions I have about <em>Jacy</em> -- &quot;Why references?&quot;</p><p>I want to have a language that I can use to develop high-level stuff as far as low level, mix them, and doing it as easily as possible.
When these two worlds meet, many questions arise: working with memory directly requires opening memory management mechanisms to the user whereas high-level programming often hides it.
This is why so many languages exist: some aimed at general low-level programming, some to general high-level programming, even some aimed to work with a very specific domain like smart contracts.
<em>Jacy</em> is a general-purpose programming language, and I have to say that it is a low-level PL.
Anyway, I don&#x27;t want to miss an approach that would make <em>Jacy</em> more high-level and convenient to use.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="move-semantics-bring-references">Move semantics bring references?<a aria-hidden="true" class="hash-link" href="#move-semantics-bring-references" title="Direct link to heading">â€‹</a></h2><p>Maybe it would sound weird but I want to logically describe one dilemma.
I almost agreed with myself to make <em>Jacy</em> more similar to Swift than Rust in the sense of memory management.
Swift is ref/copy by default while Rust is move-by-default.
What I want is move-by-default! And it is impossible to have both, default is one.</p><p>In my opinion, low-level programming with references as an option is better than low-level with references by default. Reference is an appendix mechanism even it is often used as the base of MM in many PLs.
Also, when you have the option to use references or not, you have more control over what are you doing.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="simplify-unless-code-dies">Simplify unless code dies<a aria-hidden="true" class="hash-link" href="#simplify-unless-code-dies" title="Direct link to heading">â€‹</a></h2><p>Rust is too explicit in my opinion, being well-designed PL, keeps you in shackles even when you&#x27;re just trying to do something a little bit simpler than required. What am I talking about? Explicitness is good when we are talking about safety, etc. but it is not required when we&#x27;re talking about code writing, however respectful.</p><p>Some things can be liberalized while saving all the safety rules in Rust.
For example: passing by reference. We have function signature, we know that function accepts reference (possibly) mutable, that is, we don&#x27;t lose safety if not requiring the user to explicitly borrow value.</p><p>Example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jc"><pre tabindex="0" class="prism-code language-jc codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">// Some non-copy type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">struct S {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    field: int,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func foo(instance: &amp;S) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(instance.field)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func main {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let s = S {field: 123};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // This is how to do it in Rust</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    foo(&amp;s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // This is how to do it in Jacy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    foo(s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Rust version:</p><ul><li>Comprehension is bipolar<ul><li>In function <code>foo</code> user knows that <code>S</code> is a reference</li><li>user cannot pass non-reference type to <code>foo</code> thus needs to explicitly borrow it</li></ul></li><li>User needs to explicitly borrow value, so code becomes noisier</li><li>If a function has to look like it accepts any value (<code>print</code> for example) -- the user needs to write a macro that prepends <code>&amp;</code> for each argument</li></ul><p><em>Jacy</em> version:</p><ul><li>Comprehension is linear: Code readers have to look for function <code>foo</code> to know if it accepts reference, and cannot always see what is going in the code.</li><li>User does not need to always add <code>&amp;</code> to borrow value</li><li>Functions like <code>print</code> can be easily made without troubles with passing non-reference types while borrowing them</li></ul><p>At first, I need to say that I like the explicitness of Rust, anyway, I need to explain why I&#x27;ve chosen the implicit version.
When you&#x27;re writing a code, most of the moves you make are about &quot;working with values&quot; and &quot;passing values to functions which are already implemented&quot; (exaggerated).
When you&#x27;re implementing a function -- you think about what values it needs to accept and what to with these values.
But when you&#x27;re implementing a function that uses already implemented one -- you rarely need to think if you&#x27;re passing your values by reference or by value.</p><p>Let me describe what am talking about:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jc"><pre tabindex="0" class="prism-code language-jc codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">struct S {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    field: int,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func byRef(instance: &amp;S) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Do something with reference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func byVal(instance: S) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Do something with value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func byMutRef(instance: &amp;mut S) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Do some mutating stuff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func example1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let s = S {field: 123};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byRef(s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byRef(s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byMutRef(s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byRef(s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byVal(s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Oops... `s` is moved in call to `byVal`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // byRef();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func example2 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let s = S {field: 123};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byRef(s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>What I want to show is that we don&#x27;t lose the safety as we still have move semantics and borrowing rules. The only change is that now passing by reference is implicit for callee that is, as I think, not bad.</p><p>That all sounds good, but...</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="problem">PROBLEM<a aria-hidden="true" class="hash-link" href="#problem" title="Direct link to heading">â€‹</a></h2><p>Yes, we don&#x27;t lose the safety and Rustish semantics of reference passing, anyway, I missed something.
Unlike C++, in Rust (and in <em>Jacy</em>) <code>&amp;T</code> has different, more specific, semantics, that is, C++ operates on types and when you pass this type by reference it is not required to be pointer-like (as Rust does). C++ specification does not tell must implementation always use pointers to implement references, that is internal behavior is implementation-relative. This is why C++ does not specify an operator for creating a reference -- you cannot make a reference manually because the compiler could decide not to wrap reference to a pointer.
In <em>Jacy</em>, as in Rust, reference is a &quot;pointer with constraint&quot; that are:</p><ul><li>References are always pointers, that is <code>T</code> and <code>&amp;T</code>, and can be thought of as <code>T</code> and <code>ReferenceOf&lt;T&gt;</code></li><li>Reference always points to valid data<ul><li>It cannot be null</li><li>It cannot be a dangling pointer</li></ul></li><li>References are strong - there&#x27;s nothing like <code>void&amp;</code> respectively to <code>void*</code></li></ul><p>Keeping this in mind some problems arise, like, <code>impl &amp;T</code>.</p><p>Example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jc"><pre tabindex="0" class="prism-code language-jc codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">struct S {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">impl SomeTrait for S {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func kek {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">impl SomeTrait for &amp;S {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func kek {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func foo&lt;T: SomeTrait&gt;(st: T) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    st.kek();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func main {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let s = S {};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    foo(s); // ???</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We passed <code>s</code> to <code>foo</code> which expects something implementing <code>SomeTrait</code>, but <code>SomeTrait</code> is implemented for both <code>S</code> and <code>&amp;S</code>, do we need to implicitly pass <code>s</code> by reference?</p><p>I would answer &quot;No&quot;, as moving <code>s</code> is nearly what the signature of function <code>foo</code> specifies -- there is no <code>&amp;</code> for type <code>T</code>, it is moved. Thus user needs to explicitly pass by reference.</p><p>So, this code will call <code>SomeTrait::kek(S)</code> (without <code>&amp;</code>).</p><p>User has to explicitly say that he wants to pass by reference (implicit pass does not exclude the existence of Rustish <code>&amp;</code> borrowing operator):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jc"><pre tabindex="0" class="prism-code language-jc codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">func main {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let s = S {};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    foo(&amp;s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Okay, the problem is solved? Actually, no. Let&#x27;s look at a more difficult example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jc"><pre tabindex="0" class="prism-code language-jc codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">struct S {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">impl SomeTrait for &amp;S {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func kek {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mod module {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    impl SomeTrait for S {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        func kek {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub func foo&lt;T: SomeTrait&gt;(s: T) {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func main {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let s = S {};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    module::foo(s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>What is <code>T</code> in <code>module::foo</code>? <code>&amp;T</code> or <code>T</code>? The answer is the same as in the example above -- the best fit for this call is <code>T</code> (without reference). Anyway, here, I want to show how difficult-to-read implicit pass-by-reference can be structured.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="conclusion">CONCLUSION<a aria-hidden="true" class="hash-link" href="#conclusion" title="Direct link to heading">â€‹</a></h2><p><strong>STATUS</strong> - IDEA IS DENIED.</p><p><strong>REVISIONS</strong> - ALLOWED</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/main/website/docs/particles/refs-&amp;-moves.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/dev-book/docs/particles/organic-jacy"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Organic _Jacy_</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/dev-book/docs/particles/soft-keywords"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Soft keywords<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#move-semantics-bring-references" class="table-of-contents__link toc-highlight">Move semantics bring references?</a></li><li><a href="#simplify-unless-code-dies" class="table-of-contents__link toc-highlight">Simplify unless code dies</a></li><li><a href="#problem" class="table-of-contents__link toc-highlight">PROBLEM</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">CONCLUSION</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/dev-book/docs/index">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/jacy" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/dev-book/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Jacy DevBook, JacyLang team.</div></div></div></footer></div>
<script src="/dev-book/assets/js/runtime~main.58d12d78.js"></script>
<script src="/dev-book/assets/js/main.c2ebe015.js"></script>
</body>
</html>